<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Command Pattern — Remote Control (Light & TV)</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link rel="preconnect" href="https://unpkg.com" />
  <style>
    :root { --bg:#0f172a; --panel:#111827; --card:#0b1220; --muted:#9aa3b2; --text:#e5e7eb; --accent:#60a5fa; --ok:#22c55e; --warn:#f59e0b; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background: radial-gradient(1200px 800px at 20% 0%, #0b1220 0%, var(--bg) 55%); color: var(--text); }
    header { padding: 28px 20px; display:flex; align-items:center; justify-content:space-between; gap:16px; border-bottom:1px solid #1f2937; position:sticky; top:0; background:linear-gradient(180deg, rgba(15,23,42,.85), rgba(15,23,42,.55)); backdrop-filter: blur(6px); }
    h1 { font-size: clamp(22px, 2.5vw, 36px); margin:0; letter-spacing:.3px; }
    .sub { color: var(--muted); font-size: 13px; }
    main { max-width: 1100px; margin: 24px auto; padding: 0 16px 80px; display:grid; grid-template-columns: 1fr; gap: 18px; }
    section { background: linear-gradient(180deg, rgba(96,165,250,.06), rgba(96,165,250,.0)); border:1px solid #1f2937; border-radius: 16px; padding: 18px; box-shadow: 0 10px 30px rgba(0,0,0,.25); }
    section h2 { margin: 6px 0 12px; font-size: 20px; }
    p, li { color: #cbd5e1; line-height: 1.55; }
    .grid { display:grid; gap:14px; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
    .pill { display:inline-block; border:1px solid #1f2937; padding:6px 10px; border-radius:999px; color:#cbd5e1; background:#0b1220; }
    pre { padding:14px; background:#0b1220; border:1px solid #1f2937; border-radius:12px; overflow:auto; }
    .mermaid { background:#0b1220; border:1px solid #1f2937; border-radius:12px; padding:10px; }
    .row { display:flex; flex-wrap:wrap; gap:10px; align-items:center; }
    .btn { appearance:none; border:1px solid #1f2937; background:#0b1220; color:var(--text); padding:10px 14px; border-radius:12px; cursor:pointer; transition:.15s ease; font-weight:600; text-decoration:none; display:inline-block; }
    .btn:hover { transform: translateY(-1px); border-color:#334155; }
    .btn.primary { background: linear-gradient(90deg, #2563eb 0%, #60a5fa 100%); border-color:#3b82f6; }
    .btn.ok { background: linear-gradient(90deg, #16a34a, #22c55e); border-color:#16a34a; }
    .btn.warn { background: linear-gradient(90deg, #d97706, #f59e0b); border-color:#d97706; }
    .btn.ghost { background:#0b1220; border-color:#1f2937; }
    .card { background:#0b1220; border:1px solid #1f2937; border-radius:12px; padding:12px; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
    footer { text-align:center; color:#9aa3b2; padding:40px 0; }
    .muted { color:#9aa3b2; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: true, theme: 'dark' });</script>
</head>
<body>
  <header>
    <div>
      <h1>Command Design Pattern — Interactive</h1>
      <div class="sub">Type: Behavioral • Encapsulate requests • Supports undo • Great for UI, editors, workflows</div>
    </div>
    <div class="row">
      <a class="btn" href="#uml">UML</a>
      <a class="btn" href="#demo">Interactive Demo</a>
      <!-- <a c lass="btn" href="#code">C# Code</a> -->
      <a class="btn" href="#simple-example">Simple Example</a>
      <a class="btn" href="#complex-example">Complex Example</a>
      <!-- <a class="btn" href="#downloads-simple">Simple Downloads</a> -->
      <!-- <a class="btn" href="#downloads-complex">Complex Downloads</a> -->
      <a class="btn" href="#uml-code">Simple Code UML</a>
      <a class="btn" href="#uml-code-complex">Complex Code UML</a>

    </div>
  </header>

  <main>
    <section>
      <h2>What & Why</h2>
      <div class="grid">
        <div class="card">
          <div class="pill">Definition</div>
          <p>
            The <strong>Command</strong> pattern turns a request into a first-class object that exposes a minimal interface
            (<span class="mono">execute()</span> and optionally <span class="mono">undo(). This lets you
            <em>decouple</em> the thing that triggers an action (<em>Invoker</em>) from the thing that knows how to do it
            (<em>Receiver</em>), while keeping the action itself (<em>Command</em>) portable and composable.
          </p>
          <ul>
            <li><strong>Roles:</strong> <em>Client</em> builds commands, <em>Invoker</em> queues/invokes them, <em>Receiver</em> performs the work.</li>
            <li><strong>Shape:</strong> <span class="mono">Command → Receiver.action()</span> (and reverse it in <span class="mono">undo()</span>).</li>
            <li><strong>Storage-friendly:</strong> Commands can be logged, serialized, scheduled, or replayed.</li>
            <li><strong>Uniform API:</strong> Every action is “just a command,” enabling consistent pipelines (queueing, audit, retries).</li>
          </ul>
          <p style="color:#9aa3b2">
            Think of it as “packaging a button click into an object” so the system can record, reorder, undo, and automate those clicks later.
          </p>
        </div>
        <div class="card">
          <div class="pill">Rationale</div>
          <ul>
            <li><strong>Decoupling:</strong> UI/controllers don’t need to know <em>how</em> an action is implemented—only which command to invoke.</li>
            <li><strong>Undo by design:</strong> By inverting effects in <span class="mono">undo()</span>, you get editor-grade history stacks.</li>
            <li><strong>Composability:</strong> Macro commands (a command of commands) enable batch/transactional operations.</li>
            <li><strong>Asynchrony &amp; queues:</strong> Commands drop cleanly into job queues, workers, and sagas with retry/backoff.</li>
            <li><strong>Auditability:</strong> Log the <em>intent</em> (“what”), not only side effects—great for analytics and compliance.</li>
            <li><strong>Testability:</strong> Commands isolate behavior; assert on <span class="mono">execute()</span>/<span class="mono">undo()</span> without wiring full UI.</li>
          </ul>
          <div style="margin-top:8px">
            <div class="pill">Trade-offs</div>
              <ul>
                <li><strong>Overhead:</strong> Many tiny classes/objects if you create one per action—consider factories or inline/lambda commands.</li>
                <li><strong>State symmetry:</strong> Proper <span class="mono">undo()</span> requires you to capture prior state (mementos/snapshots) or inverse ops.</li>
                <li><strong>Granularity choice:</strong> Too coarse = poor reuse; too fine = noisy histories and complex transactions.</li>
              </ul>
            </div>
          </div>

        
        <div class="card">
          <div class="pill">When to Use</div>
          <ul>
            <li><strong>Undo Required:</strong> Text/graphics editors, CAD, spreadsheets, IDE refactors.</li>
            <li><strong>Record &amp; Replay:</strong> Game input capture, macro recorders, automation scripts.</li>
            <li><strong>Workflow/Queue:</strong> Background jobs, retries, sagas, outbox pattern, distributed tasks.</li>
            <li><strong>Decouple UI from Domain:</strong> Menus, toolbars, hotkeys, remote controls, voice/CLI adapters.</li>
            <li><strong>Auditing/Compliance:</strong> Need to persist intents for review or compensation actions.</li>
            <li><strong>Batch/Transactional Ops:</strong> Apply/rollback a sequence as one macro (with partial failure handling).</li>
          </ul>
          <div style="margin-top:8px">
            <div class="pill">Smells it can fix</div>
              <ul>
                <li><strong>Fat Controllers:</strong> UI widgets directly mutating domain objects.</li>
                <li><strong>Unreliable Undo:</strong> Ad-hoc “reverse” logic scattered across components.</li>
                <li><strong>Hard-to-test UI:</strong> Logic trapped in click handlers instead of testable units.</li>
              </ul>
          </div>

          <div style="margin-top:8px">
            <div class="pill">Anti-cases</div>
              <ul>
                <li>One-off, trivial actions with no need for history, queuing, or reuse.</li>
                <li>Purely declarative pipelines where a rule engine or dataflow fits better.</li>
              </ul>
          </div>

        </div>


        
      </div>

        <div class="card">
          <div class="pill"><h2><strong>Common Usage in the Software Industry</strong></h2></div>
            <p>
              The Command Pattern is widely adopted across desktop, web, and enterprise software whenever actions
              need to be <strong>decoupled, queued, reversible, or logged</strong>. It provides a uniform structure for
              executing, undoing, or retrying operations without tightly coupling the UI to the business logic.
            </p>
            <ul>
              <li><strong>Text & Graphic Editors:</strong> Every user operation (typing, drawing, resizing) is a Command object.
                This enables full <em>Undo/Redo stacks</em> and action history recording.</li>
              <li><strong>Smart Home & IoT Controllers:</strong> Each button, scene, or voice action translates into a Command
                (e.g., “Turn on TV”, “Activate Movie Night”)—easy to schedule or roll back if an operation fails.</li>
              <li><strong>Game Development:</strong> Commands represent player actions. They can be recorded and replayed for
                tutorials, macros, or online synchronization.</li>
              <li><strong>Workflow Engines / Job Queues:</strong> Commands encapsulate discrete tasks, allowing them to be
                queued, persisted, retried, or distributed across systems (common in cloud microservices).</li>
              <li><strong>Database & Transaction Systems:</strong> Used to implement reversible transactions and compensation
                logic (via undo commands) for reliable operations.</li>
              <li><strong>Testing & Automation:</strong> UI automation tools (like Selenium) often record actions as Commands,
                which can later be replayed for regression testing.</li>
            </ul>
            <p>
              In summary, the Command Pattern’s ability to <em>package behavior as data</em> makes it invaluable for systems
              that require <strong>undo/redo support, logging, batching, or remote execution</strong>.
            </p>
        </div>

    </section>

    <!-- ========================= YOUTUBE VIDEOS SECTION ========================= -->
    <section id="videos">
      <h2>Video Tutorials — Command Pattern in Action</h2>
      <div class="grid">
        <div class="card">
          <div class="pill">Video 1</div>
          <p><strong>Command Design Pattern Explained Simply (with C# Example)</strong></p>
          <div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:12px;">
            <iframe
              width="560"
              height="315"
              src="https://www.youtube.com/embed/IEtwTB4Vt0E"
              title="Command Design Pattern Explained Simply"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              allowfullscreen
              style="position:absolute;top:0;left:0;width:100%;height:100%;border-radius:12px;">
            </iframe>
          </div>
        </div>

        <div class="card">
          <div class="pill">Video 2</div>
          <p><strong>Command Pattern — Real World Example (Smart Home Remote)</strong></p>
          <div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:12px;">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/9qA5kw8dcSU" 
                    title="Command Pattern Real World Example" 
                    frameborder="0" allowfullscreen
                    style="position:absolute;top:0;left:0;width:100%;height:100%;">
            </iframe>
          </div>
        </div>
      </div>
    </section>


    <section id="uml">
      <h2>UML — Class Diagram (Generic)</h2>
      <div class="mermaid">
      classDiagram
        class Command
        Command : +execute()
        Command : +undo()

        class ConcreteCommand
        ConcreteCommand : -Receiver receiver
        ConcreteCommand : +execute()
        ConcreteCommand : +undo()

        class Receiver
        Receiver : +action()

        class Invoker
        Invoker : -Command command
        Invoker : +setCommand(cmd)
        Invoker : +invoke()
        Invoker : +undo()

        class Client

        ConcreteCommand ..|> Command
        ConcreteCommand --> Receiver : calls
        Invoker --> Command : holds
        Client --> Invoker : configures
      </div>
    </section>

    <section id="participants">
      <h2>Participants in the Command Pattern</h2>
    <ul>
        <li><strong>Command</strong> – declares an interface for executing an operation.</li>
        <li><strong>ConcreteCommand</strong> – extends the Command interface, implementing the <code>Execute</code> method by invoking the corresponding operations on <em>Receiver</em>. It defines a link between the Receiver and the action.</li>
        <li><strong>Client</strong> – creates a ConcreteCommand object and sets its receiver.</li>
        <li><strong>Invoker</strong> – asks the command to carry out the request.</li>
        <li><strong>Receiver</strong> – knows how to perform the operations.</li>
    </ul>
    </section>

    <section id="demo">
      <h2>Interactive Demo — Two Toggle Buttons</h2>
      <div class="grid">
        <div class="card">
          <div class="pill">Remote</div>
          <div class="row">
            <button class="btn ok" id="btnToggleLight">Toggle Light</button>
            <button class="btn ok" id="btnToggleTV">Toggle TV</button>
          </div>
          <div class="row" style="margin-top:6px">
            <button class="btn" id="btnUndo">Undo</button>
            <button class="btn" id="btnRedo">Redo</button>
          </div>
          <p class="muted">Same button, different command based on current device state.</p>
        </div>
        <div class="card">
          <div class="pill">State</div>
          <pre id="stateView">(ready)</pre>
        </div>
        <div class="card">
          <div class="pill">History</div>
          <pre id="historyView">(empty)</pre>
        </div>
      </div>
    </section>

  

    <!-- ========================= SIMPLE EXAMPLE SECTION ========================= -->
    <section id="simple-example">
      <h2>Simple Example — Two Devices, Four Commands</h2>
      <div class="grid">
        <div class="card">
          <div class="pill">Problem (Simple)</div>
          <p>
            Build a remote that can turn a <strong>Light</strong> and a <strong>TV</strong> ON/OFF. 
            The UI should not know device internals and should support <strong>Undo</strong>.
          </p>
          <ul>
            <li>Two receivers: Light, TV.</li>
            <li>Four commands: LightOn, LightOff, TVOn, TVOff.</li>
            <li>Invoker holds history for undo/redo.</li>
          </ul>
        </div>

        <div class="card">
          <div class="pill">How Command Solves It</div>
          <ul>
            <li>Each button press maps to an <span class="mono">ICommand</span> with <span class="mono">Execute/Undo</span>.</li>
            <li>Invoker triggers commands and maintains stacks for undo/redo.</li>
            <li>Receivers expose simple actions (<span class="mono">On/Off</span>).</li>
          </ul>
          <p class="muted">Clean separation of concerns; easy to add more devices or commands later.</p>
        </div>
      </div>
    </section>

    <!-- ========================= DOWNLOADS: SIMPLE ========================= -->
    <section id="downloads-simple">
      <h2>Download C# Source — Simple Example</h2>
      <p>Download the basic two-device, four-command implementation.</p>
      <div class="row" style="margin-top:8px;">
        <a class="btn primary" href="files/simple/ICommand.cs" target="_blank" download>Simple/ICommand.cs</a>
        <a class="btn primary" href="files/simple/Light.cs" target="_blank" download>Simple/Light.cs</a>
        <a class="btn primary" href="files/simple/TV.cs" target="_blank" download>Simple/TV.cs</a>
        <a class="btn primary" href="files/simple/LightCommand.cs" target="_blank" download>Simple/LightCommand.cs</a>
        <a class="btn primary" href="files/simple/TVCommand.cs" target="_blank" download>Simple/TVCommand.cs</a>
        <a class="btn primary" href="files/simple/RemoteControl.cs" target="_blank" download>Simple/RemoteControl.cs</a>
        <a class="btn primary" href="files/simple/Program.cs" target="_blank" download>Simple/Program.cs</a>
      </div>
      <p style="margin-top:10px;">
        <a class="btn ok" href="files/simple.zip" download>⬇ Download Simple Project (ZIP)</a>
      </p>
    </section>

    <section id="uml-code">
      <h2>UML — Class Diagram (Code-Focused)</h2>
      <div class="mermaid">
        classDiagram
        direction LR
            class client { }

            class RemoteControl {
              - vector commands
              + setCommand(int slot, ICommand* command)
              + pressButton(int i)
              + undo()
              + redo()
            }

            class ICommand  {
              + execute()
              + undo()
            }

            class LightCommand {
              - Light* light
              + execute()
              + undo()
            }

            class Light {
              + on()
              + off()
            }

            class TVCommand {
              - TV* tv
              + execute()
              + undo()
            }

            class TV {
              + on()
              + off()
            }

            RemoteControl "1" --> "*" ICommand : uses
            LightCommand ..|> ICommand
            LightCommand --> Light : controls
            TVCommand ..|> ICommand
            TVCommand --> TV : controls
            client --> RemoteControl : configures
      </div>
    </section>



    <!-- ========================= COMPLEX EXAMPLE SECTION ========================= -->
    <section id="complex-example">
      <h2>Complex Example — Smart Home “Scenes” with Undo & NoOpCommand</h2>
      <div class="grid">
        <div class="card">
          <div class="pill">Problem (Complex)</div>
          <p>
            In a smart-home system, multiple devices like lights, TVs, and curtains must operate together in
            <em>coordinated scenes</em> — for example, the “Movie Night” scene turns off lights, powers on the TV, and closes curtains.
            However, several problems arise:
          </p>
          <ul>
            <li><strong>Multiple actions must run as one unit:</strong> If any step fails, previous changes must be rolled back.</li>
            <li><strong>Dynamic slots:</strong> The remote has configurable buttons that may not always be assigned a function.</li>
            <li><strong>Consistency and safety:</strong> Users should never get a crash or inconsistent state even if a slot is empty.</li>
          </ul>
          <p>
            The challenge is to design a <strong>flexible, fault-tolerant, and undo-capable</strong> structure that can handle single commands and grouped scenes uniformly.
          </p>
        </div>

        <div class="card">
          <div class="pill">How Command Pattern Solves It</div>
          <ul>
            <li><strong>MacroCommand:</strong> Bundles multiple device commands into one scene.
              Executes all steps sequentially and automatically rolls back if any step fails — ensuring atomic, consistent behavior.
            </li>
            <li><strong>NoOpCommand:</strong> Provides a safe “do nothing” default for unassigned remote slots, preventing null checks and runtime errors.</li>
            <li><strong>Undo:</strong> Each command knows how to reverse its own action, so pressing Undo restores the previous device states.</li>
            <li><strong>Decoupled RemoteControl:</strong> The invoker simply executes whatever command is assigned — no knowledge of devices or logic required.</li>
          </ul>
          <p>
            The result is a robust <em>Smart Home Controller</em> that can execute complex actions safely, undo or redo operations, and remain easily extensible for future devices or automation scenes.
          </p>
        </div>



      </div>
    </section>




    <!-- ========================= DOWNLOADS: COMPLEX ========================= -->
    <section id="downloads-complex">
      <h2>Download C# Source — Complex Example</h2>
      <p>Download the scene-based, undoable, rollback-safe implementation with NoOpCommand.</p>
      <div class="row" style="margin-top:8px;">
        <a class="btn primary" href="files/complex/ICommand.cs" target="_blank" download>Complex/ICommand.cs</a>
        <a class="btn primary" href="files/complex/NoOpCommands.cs" target="_blank" download>Complex/NoOpCommand.cs</a>
        <a class="btn primary" href="files/complex/Light.cs" target="_blank" download>Complex/Light.cs</a>
        <a class="btn primary" href="files/complex/TV.cs" target="_blank" download>Complex/TV.cs</a>
        <a class="btn primary" href="files/complex/LightCommand.cs" target="_blank" download>Complex/LightCommand.cs</a>
        <a class="btn primary" href="files/complex/TVCommand.cs" target="_blank" download>Complex/TVCommand.cs</a>
        <a class="btn primary" href="files/complex/MacroCommands.cs" target="_blank" download>Complex/MacroCommand.cs</a>
        <a class="btn primary" href="files/complex/RemoteControl.cs" target="_blank" download>Complex/RemoteControl.cs</a>
        <a class="btn primary" href="files/complex/Program.cs" target="_blank" download>Complex/Program.cs</a>
      </div>
      <p style="margin-top:10px;">
        <a class="btn ok" href="files/complex.zip" download>⬇ Download Complex Project (ZIP)</a>
      </p>
    </section>


    <section id="uml-code-complex">
      <h2>UML — Class Diagram (Complex)</h2>
      <div class="mermaid">
        classDiagram
          direction LR

          class ICommand {
            <!-- <<interface>> -->
            +Execute()
            +Undo()
          }

          class NoOpCommand {
            +Execute()
            +Undo()
          }

          class Light {
            +Location : string
            +IsOn : bool
            +On()
            +Off()
          }

          class TV {
            +Location : string
            +IsOn : bool
            +On()
            +Off()
          }

          class LightCommand {
            -light : Light
            -turnOn : bool
            +Execute()
            +Undo()
          }

          class TVCommand {
            -tv : TV
            -turnOn : bool
            +Execute()
            +Undo()
          }

          class MacroCommand {
            -steps : List~ICommand~
            +Execute()
            +Undo()
          }

          class RemoteControl {
            -slots : List~ICommand~
            +RemoteControl(slotCount=5)
            +SetCommand(slot:int, cmd:ICommand)
            +PressButton(slot:int)
            +Press(cmd:ICommand)  %% ad-hoc execute
          }

          class Program {
            <!-- <<client>> -->
          }

          %% Inheritance / realization
          NoOpCommand ..|> ICommand
          LightCommand ..|> ICommand
          TVCommand ..|> ICommand
          MacroCommand ..|> ICommand

          %% Associations
          LightCommand --> Light : controls
          TVCommand --> TV : controls
          MacroCommand o--> "0..*" ICommand : contains
          RemoteControl --> "0..*" ICommand : uses (slots)
          Program --> RemoteControl : configures
          Program --> Light
          Program --> TV

      </div>
    </section>


    <footer>
      Built to show the Command Pattern by showing UML, Coding Examples and the usage.
    </footer>
  </main>

  <script>
    // ======== Interactive JS demo — Two Toggle Buttons (simple behavior) ========
    class Light { constructor(loc){ this.location=loc; this.isOn=false; } On(){ this.isOn=true; log(`${this.location} light ON`);} Off(){ this.isOn=false; log(`${this.location} light OFF`);} }
    class TV { constructor(loc){ this.location=loc; this.isOn=false; } On(){ this.isOn=true; log(`${this.location} TV ON`);} Off(){ this.isOn=false; log(`${this.location} TV OFF`);} }

    class ICommand { execute(){} undo(){} }
    class LightOnCommand extends ICommand { constructor(l){ super(); this.l=l; this.name=`LightOn(${l.location})`; } execute(){ this.l.On(); } undo(){ this.l.Off(); } }
    class LightOffCommand extends ICommand { constructor(l){ super(); this.l=l; this.name=`LightOff(${l.location})`; } execute(){ this.l.Off(); } undo(){ this.l.On(); } }
    class TVOnCommand extends ICommand { constructor(tv){ super(); this.tv=tv; this.name=`TVOn(${tv.location})`; } execute(){ this.tv.On(); } undo(){ this.tv.Off(); } }
    class TVOffCommand extends ICommand { constructor(tv){ super(); this.tv=tv; this.name=`TVOff(${tv.location})`; } execute(){ this.tv.Off(); } undo(){ this.tv.On(); } }

    class RemoteControl {
      constructor(){ this.undoStack=[]; this.redoStack=[]; }
      press(cmd){ log(`> ${cmd.name}`); cmd.execute(); this.undoStack.push(cmd); this.redoStack=[]; render(); }
      undo(){ if(!this.undoStack.length){ log('Nothing to undo.'); return;} const c=this.undoStack.pop(); log(`< UNDO ${c.name}`); c.undo(); this.redoStack.push(c); render(); }
      redo(){ if(!this.redoStack.length){ log('Nothing to redo.'); return;} const c=this.redoStack.pop(); log(`> REDO ${c.name}`); c.execute(); this.undoStack.push(c); render(); }
    }

    const light = new Light('Living Room');
    const tv = new TV('Living Room');
    const remote = new RemoteControl();

    document.getElementById('btnToggleLight').onclick = () => {
      const cmd = light.isOn ? new LightOffCommand(light) : new LightOnCommand(light);
      remote.press(cmd);
    };
    document.getElementById('btnToggleTV').onclick = () => {
      const cmd = tv.isOn ? new TVOffCommand(tv) : new TVOnCommand(tv);
      remote.press(cmd);
    };

    document.getElementById('btnUndo').onclick = () => remote.undo();
    document.getElementById('btnRedo').onclick = () => remote.redo();

    const stateView = document.getElementById('stateView');
    const historyView = document.getElementById('historyView');

    function render(){
      stateView.textContent = `Light: ${light.isOn? 'ON':'OFF'}\nTV: ${tv.isOn? 'ON':'OFF'}`;
      historyView.textContent = remote.undoStack.length
        ? remote.undoStack.slice().reverse().map(c=>c.name).join('\n')
        : '(empty)';
    }
    function log(msg){ console.log(msg); }
    render();
  </script>
</body>
</html>
